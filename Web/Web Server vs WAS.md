## Web Server vs WAS

**정적 리소스**: 별도의 서버에서의 처리 없이 단순히 조회되는 리소스로, 모든 사용자에게 동일하게 보여짐 ex. HTML, CSS, JS, 이미지, 영상 등

**동적 리소스**: DB에서 데이터 조회 등 별도의 서버에서의 처리 결과가 포함된 리소스로, 사용자별로 다르게 보여짐

### Web Server(웹 서버)

> HTTP 프로토콜을 기반으로 클라이언트가 요청한 정적 리소스를 제공하는 서버

- 정적 리소스 제공이 주요 기능
- 애플리케이션 로직 같은 동적인 처리가 필요한 경우에는 웹 애플리케이션 호출
- ex. Nginx, Apache HTTP Server

<br/>

### CGI(Common GateWay Interface)와 서블릿(Servlet)

- 웹 서버와 웹 애플리케이션이 서로 다른 언어, 체계로 만들어졌기 때문에 데이터를 주고 받는 방식에 대한 규칙이 필요 → CGI(Common GateWay Interface)
- CGI 프로그램: CGI를 따라 작성된 프로그램, 기본적으로 동적인 처리를 하는 웹 애플리케이션을 실행 + 실행 결과를 다시 웹 서버로 전달해주는 역할
- Java와 CGI 프로그램
  - 자바로 만든 CGI 프로그램이 서블릿, 웹 서버와 직접 데이터를 주고 받지 않으며 별도의 프로그램에 의해 관리되는 것이 다른 CGI 프로그램과의 차이점
  - 서블릿을 관리하는 별도의 프로그램이 서블릿 컨테이너
  - 서블릿(Servlet): Server + Applet의 합성어로, 클라이언트에게 서비스를 제공하는 작은 단위의 서버 프로그램
  - 서블리 컨테이너(Servlet Container): 서블릿을 대신해 CGI 규칙에 따라 웹 서버와 데이터를 주고 받음

**서블릿 컨테이너와 서블릿**

- 서블릿 컨테이너는 서블릿들의 생성, 실행, 파괴의 라이프 사이클을 관리 + HTTP 요청의 복잡성을 처리(ex. HTTP 요청을 파싱하여 `HttpServletRequest` 객체 생성) + α
- 서블릿 컨테이너는 웹 서버와 소켓으로 통신하여 클라이언트의 요청에 응답
- 클라이언트의 요청에 매핑되는 서블릿의 메소드를 호출하여 애플리케이션 로직 수행
- 자바에서의 WAS는 Java EE 사양을 준수하여 만든 서버로, 서블릿 컨테이너의 기능 + α

<br/>

### WAS(웹 애플리케이션 서버, Web Application Server)

> 웹 서버로부터 오는 동적인 요청을 처리하는 서버, 웹 서버 + 컨테이너

- 컨테이너: 동적인 데이터들을 처리하여 정적인 페이지로 생성해주는 소프트웨어 모듈, 자바의 경우 서블릿 컨테이너
- 프로그램 코드를 실행해 애플리케이션 로직 수행 (ex. 동적 HTML, REST API, 서블릿, JSP, 스프링 MVC) → 사용자별 다른 응답 가능
- 웹 서버만 사용 시 모든 요청에 대한 결과값을 미리 만들어 놓고 서비스해야 함 → 자원 소모↑
- 반면 WAS는 요청에 따라 DB에서 데이터를 조회하거나 비즈니스 로직을 수행하여 그때 그때 결과를 만들어서 응답 → 자원의 효율적인 사용 가능
- ex. Tomcat, JBoss, Jeus, Web Sphere 등

<br/>

### Web Server vs WAS

> Web Server는 정적 리소스(파일), WAS는 애플리케이션 로직 처리

- 실제로 둘의 용어도, 경계도 모호
- 웹 서버도 프로그램 코드를 실행하는 기능 포함
- 웹 애플리케이션 서버도 웹 서버 기능 제공 + 애플리케이션 코드를 실행하는데 더 특화
- 결론적으로 어떤 타입의 컨텐츠(동적, 정적)를 주로 제공하느냐에 따라 구분

**WAS + DB 시스템 구성**

<img src="https://github.com/jkde7721/cs-interview-study/assets/65665065/efb80569-9216-4740-8466-ed1ae57fde07" width="50%"/>

- 가능하나 이 경우 WAS가 너무 많은 역할을 담당하여 서버 과부하 발생
- 정적 리소스 처리 떄문에 애플리케이션 로직 수행이 어려울 수 있음 + WAS 장애 시 오류 화면도 노출 불가능
  - HTML 문서에 포함된 이미지 파일 등의 정적 파일은 HTML 문서와 함께 보내지지 않음
  - 먼저 HTML 문서를 받고 필요한 이미지 파일들을 서버에 재요청
  - 즉 1개의 HTML 문서 요청이더라도 정적 리소스에 대한 여러 개의 요청이 발생할 수 있음

**Web Server + WAS + DB 시스템 구성** (일반적)

<img src="https://github.com/jkde7721/cs-interview-study/assets/65665065/bf671f48-c2ba-435d-be07-05466d7f6423" width="60%"/>

- 정적 리소스는 웹 서버가 처리
- 애플리케이션 로직은 WAS가 처리
- 웹 서버는 애플리케이션 로직 같은 동적인 처리가 필요하면 WAS에 요청 위임

**장점**

- 기능을 분리하여 서버 부하 방지

  - 웹 서버는 웹 페이지를 단순히 호스팅하고 렌더링하는 작업이 대부분 → WAS에 비해 많은 자원 소모X
  - 단순한 정적 컨텐츠는 웹 서버에서 빠르게 클라이언트에게 제공
  - WAS는 DB 조회, 비즈니스 로직 등을 처리하는데 집중

- 효유적인 리소스 관리 가능

  - 정적 리소스가 많이 사용되면 웹 서버 증설
  - 애플리케이션 리소스가 많이 사용되면 WAS 증설

- 물리적으로 분리하여 보안 강화

  - 웹 서버가 SSL에 대한 암호화 및 복호화 처리
  - 웹 서버가 접근 허용 IP 관리

- 장애 극복 및 대응에 유리
  - 무중단 운영을 위한 장애 극복에 보다 쉽게 대응 가능
  - 정적 리소스만 제공하는 웹 서버는 잘 죽지 않음 (단순 파일 조회) / 애플리케이션 로직이 동작하는 WAS는 잘 죽음
  - WAS, DB 장애 시에도 웹 서버가 오류 화면 제공 가능
  - (여러 대의 WAS를 사용하는 대용량 웹 애플리케이션의 경우) 앞 단의 웹 서버는 정상적으로 동작하는 WAS에게만 요청 위임 → 특정 WAS에 오류가 발생해도 사용자는 서비스 이용 가능

<br/>

### 참고

[스프링 MVC 1편 - 백엔드 웹 개발 핵심 기술](https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-mvc-1/dashboard)

[Web Server/WAS/Web Container](https://inpa.tistory.com/entry/WEB-%F0%9F%8C%90-%EC%9B%B9-%EC%84%9C%EB%B9%84%EC%8A%A4-%EA%B5%AC%EC%A1%B0-%EC%A0%95%EB%A6%AC#%EC%9B%B9_%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88_container)

[CGI, 서블릿 컨테이너](https://jinbroing.tistory.com/205)

[서블릿과 서블릿 컨테이너의 개념](https://lasbe.tistory.com/91)

[서블릿 간단 요약](https://php-style.selfhow.com/post/?id=1310#:~:text=%EC%9E%90%EB%B0%94%EB%A1%9C%20%EB%A7%8C%EB%93%A0%20CGI%20%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%A8%EC%9D%84%20%27%EC%84%9C%EB%B8%94%EB%A6%BF%28Servlet%29%27%20%EC%9D%B4%EB%9D%BC%EA%B3%A0%20%ED%95%A9%EB%8B%88%EB%8B%A4.%20%EC%9B%B9,%ED%95%84%EC%9A%94%EB%8A%94%20%EC%97%86%EC%A7%80%EB%A7%8C%20%EC%84%9C%EB%B8%94%EB%A6%BF%EA%B3%BC%20%EC%84%9C%EB%B8%94%EB%A6%BF%20%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88%EC%97%90%20%EB%8C%80%ED%95%B4%EC%84%9C%EB%8A%94%20%EC%95%8C%EC%95%84%EC%95%BC%20%ED%95%A9%EB%8B%88%EB%8B%A4.)
