## 이상 현상(Anomaly) & 정규화(Normalization)
### 이상 현상(Anomaly)
#### - 이상 현상이란?
* 한 릴레이션에 여러 엔티티의 속성 혼합 시 정보가 중복 저장됨
* 이러한 불필요한 데이터 중복으로 인해 릴레이션에 대한 연산(데이터 삽입, 수정, 삭제)을 할 때 발생하는 부작용
* = 중복 저장된 데이터들로 인해 테이블 조작 시 발생하는 데이터 불일치 문제
<br/>

#### - 이상 현상 종류
1. 삽입 이상 (insertion anomaly)
    
    * 원치 않는 데이터가 삽입되는 문제
    * key가 없어 삽입하지 못하는 데이터 삽입을 위해 불필요한 데이터도 추가로 삽입해야 하는 문제

2. 갱신 이상 (deletion anomaly)
    
    * 일부만 변경하여 데이터가 불일치하게 되는 문제
    * 중복되는 튜플이 존재하게 되는 문제

3. 삭제 이상 (update anomaly)
    
    * 특정 데이터 삭제 시, 튜플 전체가 삭제되어 필요한 데이터까지 같이 삭제되는 데이터 손실 문제<br/>
<br/>

---
### 정규화(Normalization)
#### - 정규화란?
* 속성(Attribute)간의 종속성으로 인해 이상 현상이 발생하는 릴레이션을 분해하여 재디자인하는 과정
* Goal : 데이터의 중복 방지, 무결성 충족
* = 이상 현상 제거 및 해결 위해 DB를 올바르게 설계해 나가는 과정
<br/>

#### - 정규화 원칙
1. 정보의 무손실 : 분해된 릴레이션이 표현하는 정보는 분해되기 전의 정보 모두 포함
2. 최소 데이터 중복 : 이상 현상 제거 & 데이터 중복 최소화
3. 분리의 원칙 : 하나의 독립된 관계성은 하나의 독립된 릴레이션으로 분리해서 표현
4. 이 모든 과정에서 함수 종속성을 판단하여 정규화 진행
<br/>

#### - 정규화 장점
* 각종 이상 현상 해결 가능
* DB구조 확장 시(새로운 속성 추가로), 구조의 변경 최소화 : DB연동 응용프로그램의 생명 연장
* 정규화된 릴레이션 간의 관계가 현실 세계에서의 개념 간의 관계를 잘 나타냄
* But ! 릴레이션의 분해로 연산 증가로 응답 시간이 오히려 느려질 수도 있ㅇㅇ -> 반정규화로 성능 향상 가능
<br/>

#### - 반정규화란?
* 시스템 성능 향상 위해 정규화된 데이터 모델을 통합하는 작업.. 의도적으로 정규화 원칙 위배(↔ 정규화)
* 테이블 통합&분할&추가, 중복 속성 추가 etc
* 테이블이 단순해지고 관리 효율성 증가
* but 데이터 일관성 및 무결성은 보장X, 의도적인 중복 생성으로 검색 기능은 향상되지만 갱신과 삭제 등의 성능은 감소
* 반정규화 대상

  > * 수행 속도가 많이 느린 경우
  > * 테이블의 JOIN 연산 과다 사용으로 데이터 조회가 기술적으로 어려울 경우
  > * 테이블에 많은 데이터가 존재하며 다량의 범위 or 특정 범위를 자주 처리해야 하는 경우
<br/>

---
### 함수 종속성(Functional Dependency)
#### - 함수 종속성이란?
* 어떤 테이블의 속성 X와 Y에 대하여 함수적으로 Y값에 의해 X값이 유일하게 결정되는 관계
  > "X가 Y를 함수적으로 결정한다" = "Y가 X에 함수적으로 종속되어 있다" = "Y는 X에 함수 종속이다"
  > 기호 표현 : X → Y
  > X는 결정자(Determinant), Y는 종속자(Dependant)

* 함수 종속 관계 판단 시, 현재의 속성 값을 기준으로 판단하면 안되고 속성에 들어올 수 있는 값들 고려하여 판단해야함
* 일반적으로 기본키와 후보키는 릴레이션의 다른 모든 속성들을 함수적으로 결정
<br/>

#### - 함수 종속성 종류
1. 완전 함수 종속 (Full Fuctional Dependency)

   * 가장 일반적 : 일반적으로 함수 종속은 완전 함수 종속을 의미
   * X -> Y 일 때, 속성 집합 X의 일부분에는 Y가 종속되어 있지 않음 
2. 부분 함수 종속 (Partial Functional Dependency)

   * X -> Y 일 때, 속성 집합 X의 부분 집합에도 Y가 종속되어 있음
3. 이행적 함수 종속 (Transitive Fuctional Dependency)

   * X -> Y, Y -> Z 일 때 논리적으로 X -> Z 성립 = Z가 X에 이행적으로 함수 종속되어 있음
4. EX) <br/>
<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FxkWwB%2FbtraJnE3ih7%2FGtk3ttybKqJzPHgIjTUAA1%2Fimg.png"><br/>
&emsp; 위와 같은 테이블에서 기본키는 '학번, 과목번호' <br/>
&emsp; 이름과 학년은 학번만 알아도 유일하게 결정됨. 성적은 학번과 과목번호 모두 알아야 유일하게 결정됨
<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FuFt88%2Fbtrat196XQO%2FMP47NALVFTkKLjSOI7HbxK%2Fimg.png"><br/>
&emsp; 그러므로 위 그림과 같이 학번, 과목번호에 대해 부분 함수 종속 : 학년과 이름 / 완전 함수 종속 : 성적
<br/>

---

### 참고
[[DB] 데이터베이스 정규화와 이상 현상 (Normalization & Anomaly)](https://zz132456zz.tistory.com/36) <br/>
[[DB] 7. 정규화 & 함수 종속성 & 이상현상](https://rebro.kr/159)
